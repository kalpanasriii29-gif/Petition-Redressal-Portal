{"ast":null,"code":"import React,{useEffect,useState}from'react';import{listPetitions,updateStatus,addResponse}from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Dashboard(){const[rows,setRows]=useState([]);const[error,setError]=useState('');const[loading,setLoading]=useState(true);useEffect(()=>{(async()=>{try{const data=await listPetitions({});setRows(data);}catch(err){var _err$response,_err$response$data;setError((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to load');}finally{setLoading(false);}})();},[]);const changeStatus=async(id,status)=>{await updateStatus(id,status);setRows(rows=>rows.map(r=>r.id===id?{...r,status}:r));};const addNote=async id=>{const text=prompt('Enter response');if(!text)return;await addResponse(id,{response_text:text,is_final:false});alert('Response added');};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:\"Loading...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"p-6 text-red-600\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold mb-4\",children:\"Official Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded shadow overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-100\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-left p-2\",children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left p-2\",children:\"Dept\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left p-2\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left p-2\",children:\"Priority\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left p-2\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map(r=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2 font-mono\",children:r.petition_id}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.to_department}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.status}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.priority}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-2 py-1 bg-blue-600 text-white rounded\",onClick:()=>changeStatus(r.id,'in_progress'),children:\"In Progress\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-2 py-1 bg-green-600 text-white rounded\",onClick:()=>changeStatus(r.id,'resolved'),children:\"Resolve\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-2 py-1 bg-red-600 text-white rounded\",onClick:()=>changeStatus(r.id,'rejected'),children:\"Reject\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-2 py-1 bg-gray-200 rounded\",onClick:()=>addNote(r.id),children:\"Add Response\"})]})]},r.id))})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","listPetitions","updateStatus","addResponse","jsx","_jsx","jsxs","_jsxs","Dashboard","rows","setRows","error","setError","loading","setLoading","data","err","_err$response","_err$response$data","response","message","changeStatus","id","status","map","r","addNote","text","prompt","response_text","is_final","alert","className","children","petition_id","to_department","priority","onClick"],"sources":["/workspace/petition-system/frontend/src/pages/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { listPetitions, updateStatus, addResponse } from '../utils/api';\n\nexport default function Dashboard() {\n  const [rows, setRows] = useState([]);\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const data = await listPetitions({});\n        setRows(data);\n      } catch (err) {\n        setError(err?.response?.data?.message || 'Failed to load');\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  const changeStatus = async (id, status) => {\n    await updateStatus(id, status);\n    setRows((rows) => rows.map((r) => (r.id === id ? { ...r, status } : r)));\n  };\n\n  const addNote = async (id) => {\n    const text = prompt('Enter response');\n    if (!text) return;\n    await addResponse(id, { response_text: text, is_final: false });\n    alert('Response added');\n  };\n\n  if (loading) return <div className=\"p-6\">Loading...</div>;\n  if (error) return <div className=\"p-6 text-red-600\">{error}</div>;\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-semibold mb-4\">Official Dashboard</h1>\n      <div className=\"bg-white rounded shadow overflow-x-auto\">\n        <table className=\"min-w-full text-sm\">\n          <thead className=\"bg-gray-100\">\n            <tr>\n              <th className=\"text-left p-2\">ID</th>\n              <th className=\"text-left p-2\">Dept</th>\n              <th className=\"text-left p-2\">Status</th>\n              <th className=\"text-left p-2\">Priority</th>\n              <th className=\"text-left p-2\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {rows.map((r) => (\n              <tr key={r.id} className=\"border-t\">\n                <td className=\"p-2 font-mono\">{r.petition_id}</td>\n                <td className=\"p-2\">{r.to_department}</td>\n                <td className=\"p-2\">{r.status}</td>\n                <td className=\"p-2\">{r.priority}</td>\n                <td className=\"p-2 flex gap-2\">\n                  <button className=\"px-2 py-1 bg-blue-600 text-white rounded\" onClick={() => changeStatus(r.id, 'in_progress')}>In Progress</button>\n                  <button className=\"px-2 py-1 bg-green-600 text-white rounded\" onClick={() => changeStatus(r.id, 'resolved')}>Resolve</button>\n                  <button className=\"px-2 py-1 bg-red-600 text-white rounded\" onClick={() => changeStatus(r.id, 'rejected')}>Reject</button>\n                  <button className=\"px-2 py-1 bg-gray-200 rounded\" onClick={() => addNote(r.id)}>Add Response</button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,aAAa,CAAEC,YAAY,CAAEC,WAAW,KAAQ,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExE,cAAe,SAAS,CAAAC,SAASA,CAAA,CAAG,CAClC,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACW,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,CAAC,SAAY,CACX,GAAI,CACF,KAAM,CAAAgB,IAAI,CAAG,KAAM,CAAAd,aAAa,CAAC,CAAC,CAAC,CAAC,CACpCS,OAAO,CAACK,IAAI,CAAC,CACf,CAAE,MAAOC,GAAG,CAAE,KAAAC,aAAA,CAAAC,kBAAA,CACZN,QAAQ,CAAC,CAAAI,GAAG,SAAHA,GAAG,kBAAAC,aAAA,CAAHD,GAAG,CAAEG,QAAQ,UAAAF,aAAA,kBAAAC,kBAAA,CAAbD,aAAA,CAAeF,IAAI,UAAAG,kBAAA,iBAAnBA,kBAAA,CAAqBE,OAAO,GAAI,gBAAgB,CAAC,CAC5D,CAAC,OAAS,CACRN,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,EAAE,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAO,YAAY,CAAG,KAAAA,CAAOC,EAAE,CAAEC,MAAM,GAAK,CACzC,KAAM,CAAArB,YAAY,CAACoB,EAAE,CAAEC,MAAM,CAAC,CAC9Bb,OAAO,CAAED,IAAI,EAAKA,IAAI,CAACe,GAAG,CAAEC,CAAC,EAAMA,CAAC,CAACH,EAAE,GAAKA,EAAE,CAAG,CAAE,GAAGG,CAAC,CAAEF,MAAO,CAAC,CAAGE,CAAE,CAAC,CAAC,CAC1E,CAAC,CAED,KAAM,CAAAC,OAAO,CAAG,KAAO,CAAAJ,EAAE,EAAK,CAC5B,KAAM,CAAAK,IAAI,CAAGC,MAAM,CAAC,gBAAgB,CAAC,CACrC,GAAI,CAACD,IAAI,CAAE,OACX,KAAM,CAAAxB,WAAW,CAACmB,EAAE,CAAE,CAAEO,aAAa,CAAEF,IAAI,CAAEG,QAAQ,CAAE,KAAM,CAAC,CAAC,CAC/DC,KAAK,CAAC,gBAAgB,CAAC,CACzB,CAAC,CAED,GAAIlB,OAAO,CAAE,mBAAOR,IAAA,QAAK2B,SAAS,CAAC,KAAK,CAAAC,QAAA,CAAC,YAAU,CAAK,CAAC,CACzD,GAAItB,KAAK,CAAE,mBAAON,IAAA,QAAK2B,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAEtB,KAAK,CAAM,CAAC,CAEjE,mBACEJ,KAAA,QAAKyB,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClB5B,IAAA,OAAI2B,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,cACnE5B,IAAA,QAAK2B,SAAS,CAAC,yCAAyC,CAAAC,QAAA,cACtD1B,KAAA,UAAOyB,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACnC5B,IAAA,UAAO2B,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC5B1B,KAAA,OAAA0B,QAAA,eACE5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,IAAE,CAAI,CAAC,cACrC5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,MAAI,CAAI,CAAC,cACvC5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,QAAM,CAAI,CAAC,cACzC5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,UAAQ,CAAI,CAAC,cAC3C5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,SAAO,CAAI,CAAC,EACxC,CAAC,CACA,CAAC,cACR5B,IAAA,UAAA4B,QAAA,CACGxB,IAAI,CAACe,GAAG,CAAEC,CAAC,eACVlB,KAAA,OAAeyB,SAAS,CAAC,UAAU,CAAAC,QAAA,eACjC5B,IAAA,OAAI2B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAER,CAAC,CAACS,WAAW,CAAK,CAAC,cAClD7B,IAAA,OAAI2B,SAAS,CAAC,KAAK,CAAAC,QAAA,CAAER,CAAC,CAACU,aAAa,CAAK,CAAC,cAC1C9B,IAAA,OAAI2B,SAAS,CAAC,KAAK,CAAAC,QAAA,CAAER,CAAC,CAACF,MAAM,CAAK,CAAC,cACnClB,IAAA,OAAI2B,SAAS,CAAC,KAAK,CAAAC,QAAA,CAAER,CAAC,CAACW,QAAQ,CAAK,CAAC,cACrC7B,KAAA,OAAIyB,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC5B5B,IAAA,WAAQ2B,SAAS,CAAC,0CAA0C,CAACK,OAAO,CAAEA,CAAA,GAAMhB,YAAY,CAACI,CAAC,CAACH,EAAE,CAAE,aAAa,CAAE,CAAAW,QAAA,CAAC,aAAW,CAAQ,CAAC,cACnI5B,IAAA,WAAQ2B,SAAS,CAAC,2CAA2C,CAACK,OAAO,CAAEA,CAAA,GAAMhB,YAAY,CAACI,CAAC,CAACH,EAAE,CAAE,UAAU,CAAE,CAAAW,QAAA,CAAC,SAAO,CAAQ,CAAC,cAC7H5B,IAAA,WAAQ2B,SAAS,CAAC,yCAAyC,CAACK,OAAO,CAAEA,CAAA,GAAMhB,YAAY,CAACI,CAAC,CAACH,EAAE,CAAE,UAAU,CAAE,CAAAW,QAAA,CAAC,QAAM,CAAQ,CAAC,cAC1H5B,IAAA,WAAQ2B,SAAS,CAAC,+BAA+B,CAACK,OAAO,CAAEA,CAAA,GAAMX,OAAO,CAACD,CAAC,CAACH,EAAE,CAAE,CAAAW,QAAA,CAAC,cAAY,CAAQ,CAAC,EACnG,CAAC,GAVER,CAAC,CAACH,EAWP,CACL,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,EACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}